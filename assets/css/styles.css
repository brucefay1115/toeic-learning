/* Global styles for TOEIC AI Tutor */
:root {
    --primary: #5856D6;
    --primary-light: #E0E0FF;
    --accent: #FF9500;
    --bg: #F2F2F7;
    --card-bg: #FFFFFF;
    --text-main: #1C1C1E;
    --text-sub: #8E8E93;
    --highlight: #FFD60A;
    --highlight-text: #000000;
    --success: #34C759;
    --danger: #FF3B30;
    --radius: 20px;
    --shadow: 0 4px 20px rgba(0,0,0,0.06);
    --safe-area-bottom: env(safe-area-inset-bottom);
    --tab-bar-height: 56px;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    font-family: 'Inter', 'Noto Sans TC', sans-serif;
    background-color: var(--bg);
    color: var(--text-main);
    margin: 0;
    padding: 0;
    padding-bottom: calc(var(--tab-bar-height) + 80px + var(--safe-area-bottom));
}

.hidden { display: none !important; }
.container { max-width: 600px; margin: 0 auto; padding: 20px; }

header {
    background: rgba(255,255,255,0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    position: sticky;
    top: 0;
    z-index: 100;
    padding: 15px 20px;
    border-bottom: 1px solid rgba(0,0,0,0.05);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

h1 { font-size: 20px; margin: 0; font-weight: 700; color: var(--primary); }

.settings-btn {
    background: none; border: none; font-size: 22px; cursor: pointer;
    color: var(--text-sub); display: flex; align-items: center; justify-content: center;
    width: 36px; height: 36px; border-radius: 50%; transition: background 0.2s;
}
.settings-btn:active { background: rgba(0,0,0,0.05); }

.tab-bar {
    position: fixed; bottom: 0; left: 0; width: 100%;
    background: rgba(255,255,255,0.95); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid rgba(0,0,0,0.08); display: flex; justify-content: space-around;
    align-items: stretch; height: calc(var(--tab-bar-height) + var(--safe-area-bottom));
    padding-bottom: var(--safe-area-bottom); z-index: 600;
}
.tab-btn {
    flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
    background: none; border: none; font-size: 11px; color: var(--text-sub); cursor: pointer;
    padding: 6px 0; gap: 2px; transition: color 0.2s;
}
.tab-btn .tab-icon { font-size: 22px; line-height: 1; display: flex; align-items: center; justify-content: center; }
.tab-btn .tab-label { font-weight: 500; }
.tab-btn.active { color: var(--primary); }

.modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.4); z-index: 1000; display: none;
    align-items: center; justify-content: center;
}
.modal-overlay.active { display: flex; }
.modal-card {
    background: var(--card-bg); width: 90%; max-width: 350px; padding: 24px;
    border-radius: var(--radius); box-shadow: var(--shadow); text-align: center;
}
#keyModal .settings-section {
    text-align: left;
}
#keyModal .settings-label-center {
    text-align: center;
}
#keyModal .settings-section + .settings-section {
    border-top: 1px solid #e6e6e6;
    margin-top: 16px;
    padding-top: 16px;
}
#keyModal .settings-api-guide-link {
    display: flex;
    justify-content: center;
    text-align: center;
}
#keyModal .settings-bottom-actions {
    display: flex;
    gap: 8px;
    margin-top: 14px;
}
#keyModal .settings-action-btn {
    flex: 1;
    width: auto;
    margin: 0;
}
#keyModal #btnCloseKeyModal.settings-action-btn {
    display: none;
    align-items: center;
    justify-content: center;
}
.api-guide-link {
    display: inline-flex; align-items: center; gap: 6px; margin-bottom: 15px;
    color: var(--primary); text-decoration: none; font-size: 14px; font-weight: 500;
    border: 1px solid var(--primary-light); padding: 8px 12px; border-radius: 8px; background: #f9f9ff;
}
.input-group {
    display: flex;
    gap: 8px;
    align-items: stretch;
    margin: 5px 0 15px;
}
.input-group input {
    flex: 1;
    min-width: 0;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 12px;
    margin: 0;
    font-size: 16px;
}
.api-clear-btn {
    flex-shrink: 0;
    padding: 0 12px;
    border: 1px solid #ddd;
    border-radius: 12px;
    background: #f5f5f5;
    color: var(--text-sub);
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
}
.api-clear-btn:active { background: #ececec; }

.score-selector { display: flex; flex-wrap: wrap; gap: 10px; padding: 10px 0; justify-content: center; }
.score-chip {
    padding: 12px 24px; background: white; border-radius: 50px; font-weight: 600; font-size: 16px;
    color: var(--text-sub); border: 2px solid transparent; cursor: pointer; transition: all 0.2s ease; white-space: nowrap;
}
.score-chip.active { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(88,86,214,0.3); }

.generate-btn {
    width: 100%; padding: 16px; background: var(--text-main); color: white; border: none;
    border-radius: var(--radius); font-size: 16px; font-weight: 600; margin: 20px 0;
    cursor: pointer; transition: transform 0.1s;
}
.generate-btn:active { transform: scale(0.98); }
.generate-btn:disabled { opacity: 0.5; cursor: not-allowed; }

.empty-state { text-align: center; padding: 60px 20px; color: var(--text-sub); }
.empty-state .empty-icon { font-size: 48px; margin-bottom: 16px; display: flex; align-items: center; justify-content: center; }
.empty-state p { font-size: 16px; margin: 8px 0; line-height: 1.45; }
.empty-state .cta-btn {
    display: inline-block; margin-top: 20px; padding: 12px 28px; background: var(--primary);
    color: white; border: none; border-radius: 50px; font-size: 15px; font-weight: 600; cursor: pointer;
}

.article-card {
    background: var(--card-bg); border-radius: var(--radius); padding: 24px;
    box-shadow: var(--shadow); margin-bottom: 20px; position: relative; min-height: 200px;
}
.article-meta { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
.voice-badge {
    display: inline-flex; align-items: center; gap: 4px; font-size: 12px;
    color: var(--primary); background: var(--primary-light); padding: 3px 10px;
    border-radius: 20px; font-weight: 500;
}

.segment-row { margin-bottom: 16px; border-radius: 8px; transition: background 0.2s; }
.segment-en {
    font-size: 19px; line-height: 1.6; color: #333; margin-bottom: 4px; padding: 4px;
    border-radius: 6px; transition: background 0.2s; display: flex; align-items: flex-start; gap: 2px; flex-wrap: wrap;
}
.segment-en.active { background-color: var(--highlight); color: var(--highlight-text); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.segment-en .en-text { flex: 1; }
.segment-zh {
    font-size: 15px; color: var(--text-sub); line-height: 1.5; padding-left: 8px;
    border-left: 2px solid var(--primary-light); margin-top: 6px; transition: all 0.3s ease;
}
.segment-replay-btn {
    display: inline-flex; align-items: center; justify-content: center;
    width: 24px; height: 24px; min-width: 24px; border-radius: 50%;
    background: transparent; border: 1.5px solid var(--primary-light);
    cursor: pointer; color: var(--primary); margin-top: 2px;
    flex-shrink: 0; transition: all 0.2s; padding: 0;
}
.segment-replay-btn:active { background: var(--primary-light); }

.segment-en.en-hidden .en-text { visibility: hidden; }

.word-interactive {
    cursor: pointer; -webkit-touch-callout: none; -webkit-user-select: none;
    user-select: none; border-radius: 4px; transition: background 0.15s;
}
.word-pressing { background: rgba(88, 86, 214, 0.2); }
.word-highlighted { background: var(--primary-light); }

.toggle-btn-row { display: flex; gap: 8px; margin-top: 12px; }
.translate-toggle-btn {
    display: inline-flex; align-items: center; justify-content: center;
    background: var(--primary-light); color: var(--primary); border: none;
    padding: 8px 16px; border-radius: 20px; font-weight: 600; font-size: 13px;
    cursor: pointer; flex: 1; transition: all 0.2s;
}
.translate-toggle-btn.active-toggle { background: var(--primary); color: white; }

.player-bar {
    position: fixed; bottom: calc(var(--tab-bar-height) + var(--safe-area-bottom) + 10px);
    left: 50%; transform: translateX(-50%); width: 90%; max-width: 500px;
    background: rgba(28,28,30,0.9); backdrop-filter: blur(10px); color: white;
    padding: 12px 20px; border-radius: 50px; display: flex; align-items: center;
    justify-content: space-between; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    z-index: 500; transition: transform 0.3s cubic-bezier(0.175,0.885,0.32,1.275); gap: 15px;
}
.player-bar.hidden { transform: translate(-50%, calc(100% + 100px)); }
.play-btn {
    background: white; color: black; border: none; width: 45px; height: 45px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 20px; cursor: pointer; flex-shrink: 0;
}
.progress-container {
    flex: 1; height: 24px; position: relative; cursor: pointer;
    touch-action: none; -webkit-tap-highlight-color: transparent;
}
.progress-container::before {
    content: ''; position: absolute; left: 0; right: 0; top: 50%;
    height: 4px; transform: translateY(-50%);
    background: rgba(255,255,255,0.3); border-radius: 2px;
}
.progress-fill {
    width: 0%; position: absolute; left: 0; top: 50%;
    height: 4px; transform: translateY(-50%);
    background: var(--primary); border-radius: 2px; transition: width 0.1s linear;
}
.progress-container.dragging .progress-fill { transition: none; }
.speed-btn { background: rgba(255,255,255,0.2); border: none; color: white; border-radius: 12px; padding: 5px 10px; font-size: 12px; cursor: pointer; width: 50px; text-align: center; }

.section-title { font-size: 18px; font-weight: 700; margin: 30px 0 15px; }
.vocab-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
.vocab-card { background: white; padding: 16px; border-radius: 16px; border-left: 5px solid var(--accent); box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
.vocab-header { display: flex; justify-content: space-between; align-items: center; }
.vocab-word { font-size: 18px; font-weight: 700; color: var(--text-main); }
.vocab-pos { font-size: 12px; color: var(--text-sub); background: #f0f0f0; padding: 2px 6px; border-radius: 4px; }
.vocab-ipa { font-family: 'Times New Roman', serif; color: var(--text-sub); margin-left: 8px; }
.vocab-def { margin: 8px 0; color: #444; }
.vocab-ex { font-style: italic; color: var(--text-sub); font-size: 14px; margin-top: 5px; }
.vocab-ex-zh { font-size: 13px; color: var(--text-sub); margin-top: 3px; padding-left: 4px; }
.vocab-save-btn {
    display: inline-flex; align-items: center; justify-content: center;
    width: 28px; height: 28px; border-radius: 50%; background: #f0f0f0;
    border: none; cursor: pointer; font-size: 14px; margin-left: 6px;
    vertical-align: middle; transition: all 0.2s; color: var(--text-sub);
}
.vocab-save-btn:active { background: #d0d0d0; }
.vocab-save-btn.saved { color: var(--success); background: #e8f5e9; }

.mini-speaker {
    display: inline-flex; align-items: center; justify-content: center;
    width: 28px; height: 28px; border-radius: 50%; background: #f0f0f0;
    border: none; cursor: pointer; font-size: 14px; margin-left: 8px;
    vertical-align: middle; transition: background 0.2s; color: var(--text-sub);
}
.mini-speaker:active { background: #d0d0d0; }
.large-speaker {
    display: inline-flex; align-items: center; justify-content: center;
    width: 50px; height: 50px; border-radius: 50%;
    background: var(--primary); color: white; border: none;
    cursor: pointer; font-size: 24px; margin: 0 auto;
    box-shadow: 0 4px 10px rgba(88,86,214,0.3);
}

.phrase-list { list-style: none; padding: 0; }
.phrase-card { background: white; margin-bottom: 12px; padding: 16px; border-radius: 16px; border-left: 5px solid var(--primary); box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
.phrase-header { font-size: 17px; font-weight: 700; color: var(--primary); margin-bottom: 6px; display: flex; align-items: center; }
.phrase-meaning { font-size: 15px; color: var(--text-main); margin-bottom: 6px; }
.phrase-explanation { font-size: 14px; color: var(--text-sub); margin-bottom: 8px; line-height: 1.5; }
.phrase-example { font-style: italic; font-size: 14px; color: #555; padding-left: 10px; border-left: 2px solid var(--primary-light); display: flex; align-items: center; }
.phrase-example-zh { font-size: 13px; color: var(--text-sub); margin-top: 4px; padding-left: 10px; }

.grammar-list { list-style: none; padding: 0; }
.grammar-item { background: white; margin-bottom: 10px; padding: 15px; border-radius: 12px; display: flex; align-items: flex-start; }
.grammar-bullet { color: var(--primary); margin-right: 10px; font-weight: bold; }

.word-modal {
    position: fixed; bottom: 0; left: 0; width: 100%;
    background: white; border-top-left-radius: 24px; border-top-right-radius: 24px;
    padding: 30px; box-shadow: 0 -10px 40px rgba(0,0,0,0.1);
    transform: translateY(100%); transition: transform 0.3s ease;
    z-index: 1000; padding-bottom: max(30px, var(--safe-area-bottom));
    max-height: 80vh; overflow-y: auto;
}
.word-modal.active { transform: translateY(0); }
.wm-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
.wm-word { font-size: 32px; font-weight: 800; color: var(--text-main); }
.wm-meta { color: var(--text-sub); margin-bottom: 20px; font-size: 18px; }
.wm-def { font-size: 20px; margin-bottom: 20px; }
.wm-btn {
    background: var(--primary); color: white; border: none;
    width: 100%; padding: 15px; border-radius: 16px; font-size: 16px; font-weight: 600;
    display: flex; align-items: center; justify-content: center; gap: 8px; cursor: pointer;
}
.wm-btn.secondary { background: #f0f0f0; color: #333; margin-top: 10px; }
.wm-btn.save-btn { background: var(--success); margin-top: 10px; }
.wm-btn.saved-btn { background: #e8f5e9; color: var(--success); border: 1.5px solid var(--success); margin-top: 10px; cursor: pointer; }
.wm-actions { display: flex; flex-direction: column; margin-bottom: 10px; }

.loader { border: 3px solid rgba(0,0,0,0.1); border-left-color: var(--primary); border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display: inline-block; vertical-align: middle; margin-right: 8px; }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

.history-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: white; border-radius: 12px; margin-bottom: 10px; }
.history-content { flex: 1; cursor: pointer; }
.history-title { font-weight: 700; font-size: 15px; margin-bottom: 4px; line-height: 1.3; color: var(--text-main); }
.history-date { font-size: 13px; color: var(--text-sub); display: flex; align-items: center; gap: 4px; flex-wrap: wrap; line-height: 1.4; }
.history-score-badge { display: inline-block; font-size: 12px; font-weight: 600; background: var(--primary-light); color: var(--primary); padding: 2px 8px; border-radius: 10px; margin-left: 6px; }
.history-voice-badge { display: inline-block; font-size: 12px; font-weight: 500; background: #f0f0f0; color: var(--text-sub); padding: 2px 8px; border-radius: 10px; margin-left: 4px; }
.delete-btn { background: var(--danger); color: white; border: none; width: 30px; height: 30px; border-radius: 50%; margin-left: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; }

.practice-container { text-align: center; padding: 40px 0 20px; }
.practice-container h2 { font-size: 22px; font-weight: 700; margin-bottom: 8px; }
.practice-container .subtitle { color: var(--text-sub); font-size: 15px; margin-bottom: 30px; }
.practice-note { color: var(--text-sub); font-size: 14px; margin: 0 0 12px; line-height: 1.45; }
.practice-mode-switch {
    background: #ecebff;
    border-radius: 14px;
    padding: 5px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 6px;
}
.practice-mode-btn {
    border: none;
    border-radius: 10px;
    padding: 10px 8px;
    background: transparent;
    color: var(--text-sub);
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}
.practice-mode-btn.active {
    background: white;
    color: var(--primary);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.07);
}
.practice-mode-panel { margin-top: 20px; }
.practice-section { margin-top: 24px; text-align: left; }
.practice-label { font-size: 15px; font-weight: 600; margin: 0 0 8px; color: var(--text-main); }
.topic-input {
    width: 100%; padding: 12px 16px; border: 1.5px solid #e0e0e0; border-radius: 14px;
    font-size: 15px; font-family: inherit; outline: none; transition: border-color 0.2s;
    background: white;
}
.topic-input:focus { border-color: var(--primary); }
.voice-selector { display: flex; flex-wrap: wrap; gap: 8px; }
.topic-preset-group { display: flex; flex-wrap: wrap; gap: 8px; }
.topic-chip {
    border: 1.5px solid #ddd;
    background: white;
    border-radius: 999px;
    padding: 8px 12px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
}
.topic-chip.active {
    border-color: var(--primary);
    background: var(--primary);
    color: white;
}
.speaking-status {
    margin-top: 16px;
    background: #f5f7ff;
    border: 1px solid #dfe5ff;
    color: #3b3b6b;
    border-radius: 12px;
    font-size: 14px;
    text-align: left;
    padding: 10px 12px;
}
.practice-inline-actions {
    margin-top: 12px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}
.speaking-stop-btn {
    margin-top: 0;
    padding: 12px;
    font-size: 15px;
}
#btnStopSpeaking.speaking-stop-btn.speaking-primary-btn { background: var(--text-main); color: white; border: none; }
#btnSpeakingBack.speaking-stop-btn.speaking-secondary-btn { background: #f0f0f0; color: #333; border: none; }
#btnStopSpeaking.speaking-stop-btn:disabled,
#btnSpeakingBack.speaking-stop-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
#tabLearn #speakingSessionView {
    min-height: min(76vh, 700px);
    display: flex;
    flex-direction: column;
}
.speaking-log {
    margin-top: 14px;
    text-align: left;
    background: white;
    border-radius: 12px;
    border: 1px solid #eee;
    min-height: 420px;
    max-height: min(66vh, 620px);
    flex: 1;
    overflow-y: auto;
}
.speaking-log-item {
    padding: 10px 12px;
    border-bottom: 1px solid #f1f1f1;
    font-size: 13px;
    line-height: 1.45;
}
.speaking-log-item:last-child { border-bottom: none; }
.speaking-log-role {
    font-size: 11px;
    font-weight: 700;
    color: var(--primary);
    margin-right: 6px;
}
.exam-shell {
    margin-top: 14px;
    text-align: left;
    background: white;
    border: 1px solid #ededed;
    border-radius: 14px;
    padding: 14px;
}
.exam-meta { font-size: 14px; color: var(--text-sub); margin-bottom: 10px; }
.exam-back-btn { margin-top: 10px; }
.exam-question {
    border: 1px solid #efefef;
    border-radius: 12px;
    padding: 12px;
    margin-bottom: 10px;
}
.exam-question-title { font-weight: 600; margin-bottom: 8px; line-height: 1.4; }
.exam-passage {
    background: #fafafe;
    border: 1px solid #ececff;
    border-radius: 10px;
    padding: 8px 10px;
    margin-bottom: 8px;
    font-size: 13px;
    color: #4b4b66;
    line-height: 1.45;
}
.exam-question-type {
    display: inline-block;
    background: #f1f3ff;
    color: var(--primary);
    font-size: 12px;
    padding: 2px 8px;
    border-radius: 999px;
    margin-bottom: 8px;
}
.exam-options { display: grid; gap: 8px; }
.exam-option {
    border: 1.5px solid #e6e6e6;
    border-radius: 10px;
    background: #fff;
    padding: 10px;
    cursor: pointer;
    font-size: 15px;
}
.exam-option:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
.exam-option.active {
    border-color: var(--primary);
    background: #f6f5ff;
}
.loader-sm {
    width: 14px;
    height: 14px;
    border-width: 2px;
    margin-right: 6px;
}
.exam-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 12px;
}
.exam-result {
    background: #f7f9ff;
    border: 1px solid #e3e7ff;
    border-radius: 12px;
    padding: 12px;
    margin-bottom: 10px;
    font-size: 14px;
}
.exam-wrong-list {
    display: grid;
    gap: 8px;
}
.exam-wrong-item {
    border: 1px solid #f0f0f0;
    border-radius: 10px;
    padding: 10px;
    background: #fff;
    font-size: 14px;
    line-height: 1.45;
}
.exam-review-audio-btn {
    margin-left: 6px;
    width: 26px;
    height: 26px;
    font-size: 12px;
    vertical-align: middle;
}
.voice-chip {
    padding: 8px 14px; background: white; border-radius: 50px; font-weight: 500; font-size: 13px;
    color: var(--text-sub); border: 1.5px solid #e0e0e0; cursor: pointer; transition: all 0.2s;
    text-align: center;
}
.voice-chip .voice-desc { font-size: 10px; opacity: 0.7; display: block; }
.voice-chip.active { background: var(--primary); color: white; border-color: var(--primary); }

/* Saved Vocabulary Tab */
.vocab-tab-header { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
.vocab-tab-header .section-title { margin: 0; }
.vocab-tab-count { color: var(--text-sub); font-size: 13px; }
.review-entry-card {
    background: var(--primary); color: white; padding: 20px; border-radius: var(--radius);
    text-align: center; cursor: pointer; transition: transform 0.1s; margin: 15px 0; border: none; width: 100%;
}
.review-entry-card:active { transform: scale(0.98); }
.review-entry-card h3 { margin: 0 0 6px; font-size: 18px; font-weight: 700; }
.review-entry-card p { margin: 0; font-size: 13px; opacity: 0.85; }
.review-entry-card.disabled { background: #e0e0e0; color: var(--text-sub); cursor: default; }
.review-entry-card.disabled:active { transform: none; }
.saved-word-card { display: flex; align-items: center; padding: 14px 16px; background: white; border-radius: 14px; margin-bottom: 10px; box-shadow: 0 1px 4px rgba(0,0,0,0.04); }
.saved-word-info { flex: 1; min-width: 0; }
.saved-word-top { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; }
.saved-word-en { font-weight: 700; font-size: 16px; color: var(--text-main); }
.saved-word-zh { font-size: 14px; color: var(--text-sub); margin-top: 2px; }
.saved-word-next { font-size: 11px; color: var(--text-sub); margin-top: 3px; }
.srs-badge { display: inline-block; font-size: 10px; font-weight: 700; padding: 2px 7px; border-radius: 8px; line-height: 1.4; }
.srs-badge-0 { background: #ffebee; color: #c62828; }
.srs-badge-1 { background: #fff3e0; color: #e65100; }
.srs-badge-2 { background: #fff8e1; color: #f9a825; }
.srs-badge-3 { background: #e8f5e9; color: #2e7d32; }
.srs-badge-4 { background: #e3f2fd; color: #1565c0; }
.srs-badge-5 { background: #ede7f6; color: #4527a0; }
.saved-word-actions { display: flex; align-items: center; gap: 6px; flex-shrink: 0; margin-left: 10px; }
.saved-word-speak { background: #f0f0f0; border: none; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 14px; color: var(--text-sub); transition: background 0.2s; }
.saved-word-speak:active { background: #d0d0d0; }
.saved-word-delete { background: none; border: none; color: var(--danger); cursor: pointer; font-size: 20px; padding: 4px; display: flex; align-items: center; }

/* SRS Review Overlay */
.srs-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 2000; display: flex; flex-direction: column; overflow-y: auto; }
.srs-overlay.hidden { display: none !important; }
.srs-content { max-width: 600px; margin: 0 auto; padding: 20px; width: 100%; flex: 1; display: flex; flex-direction: column; }
.srs-top-bar { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
.srs-close-btn { background: none; border: none; font-size: 24px; cursor: pointer; color: var(--text-sub); padding: 4px; display: flex; align-items: center; }
.srs-progress-text { font-weight: 600; color: var(--text-sub); font-size: 14px; }
.srs-phase-badge { background: var(--primary-light); color: var(--primary); padding: 4px 12px; border-radius: 20px; font-size: 13px; font-weight: 600; }
.srs-question-area { text-align: center; padding: 30px 0; flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
.srs-question-word { font-size: 36px; font-weight: 800; color: var(--text-main); margin-bottom: 10px; }
.srs-question-hint { font-size: 14px; color: var(--text-sub); margin-bottom: 10px; }
.srs-listen-btn { width: 80px; height: 80px; border-radius: 50%; background: var(--primary); color: white; border: none; font-size: 32px; cursor: pointer; display: flex; align-items: center; justify-content: center; margin: 0 auto; box-shadow: 0 4px 20px rgba(88,86,214,0.3); transition: transform 0.1s; }
.srs-listen-btn:active { transform: scale(0.95); }
.srs-options-area { display: flex; flex-direction: column; gap: 12px; padding-bottom: 30px; }
.srs-option { padding: 16px 20px; background: white; border: 2px solid #e5e5e5; border-radius: 16px; font-size: 17px; font-weight: 500; cursor: pointer; transition: all 0.15s; text-align: left; }
.srs-option:active { transform: scale(0.98); }
.srs-option.correct { background: #E8F5E9; border-color: var(--success); color: #2E7D32; }
.srs-option.wrong { background: #FFEBEE; border-color: var(--danger); color: #C62828; }
.srs-option.disabled { pointer-events: none; }
.srs-result-score { font-size: 48px; font-weight: 800; color: var(--primary); margin-bottom: 6px; }
.srs-result-label { font-size: 16px; color: var(--text-sub); margin-bottom: 30px; }
.srs-result-item { display: flex; align-items: flex-start; justify-content: space-between; gap: 12px; padding: 12px 16px; background: white; border-radius: 12px; margin-bottom: 8px; text-align: left; }
.srs-result-main { min-width: 0; flex: 1; }
.srs-result-word-row { display: flex; align-items: center; gap: 4px; }
.srs-result-word { font-weight: 700; font-size: 16px; color: var(--text-main); }
.srs-result-meta { font-weight: 400; color: var(--text-sub); font-size: 12px; display: block; margin-top: 2px; }
.srs-result-ex-row { margin-top: 6px; display: flex; align-items: center; gap: 6px; }
.srs-result-ex { color: #444; font-size: 14px; line-height: 1.45; }
.srs-result-ex-zh { margin-top: 2px; color: var(--text-sub); font-size: 13px; line-height: 1.4; }
.srs-result-speaker { margin-left: 2px; width: 24px; height: 24px; font-size: 13px; flex-shrink: 0; }
.srs-result-ex-speaker { margin-left: 0; }
.srs-result-status { font-size: 12px; font-weight: 600; white-space: nowrap; text-align: right; margin-top: 2px; }
.srs-result-status.up { color: var(--success); }
.srs-result-status.down { color: var(--danger); }
.srs-result-status.same { color: var(--text-sub); }
.srs-done-btn { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; border-radius: var(--radius); font-size: 16px; font-weight: 600; margin-top: 20px; cursor: pointer; transition: transform 0.1s; }
.srs-done-btn:active { transform: scale(0.98); }
.srs-reveal-word { font-size: 22px; font-weight: 700; color: var(--primary); margin-top: 12px; animation: fadeInUp 0.3s ease; }
@keyframes fadeInUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.srs-listen3-container { display: flex; gap: 20px; justify-content: center; margin-top: 20px; }
.srs-listen3-item { display: flex; flex-direction: column; align-items: center; gap: 8px; }
.srs-listen3-btn { width: 64px; height: 64px; border-radius: 50%; background: var(--primary); color: white; border: none; font-size: 26px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 14px rgba(88,86,214,0.25); transition: transform 0.1s; }
.srs-listen3-btn:active { transform: scale(0.93); }
.srs-listen3-label { font-size: 16px; font-weight: 700; color: var(--text-main); }

/* Cloud Backup */
.header-right { display: flex; align-items: center; gap: 6px; }

.cloud-section {
    text-align: left;
}
.cloud-section h4 {
    font-size: 14px; font-weight: 600; margin: 0 0 12px; color: var(--text-main);
    display: flex; align-items: center; gap: 6px;
}
.cloud-user-info {
    display: flex; align-items: center; gap: 10px; padding: 10px;
    background: #f8f8fa; border-radius: 10px; margin-bottom: 12px;
}
.cloud-user-avatar {
    width: 36px; height: 36px; border-radius: 50%; background: var(--primary-light);
    display: flex; align-items: center; justify-content: center;
    font-weight: 700; color: var(--primary); font-size: 16px; flex-shrink: 0;
}
.cloud-user-detail { flex: 1; min-width: 0; }
.cloud-user-name { font-weight: 600; font-size: 13px; color: var(--text-main); }
.cloud-user-email { font-size: 12px; color: var(--text-sub); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.cloud-login-btn {
    width: 100%; padding: 10px; border: 1.5px solid #e0e0e0; border-radius: 10px;
    background: white; display: flex; align-items: center; justify-content: center;
    gap: 8px; font-size: 14px; font-weight: 500; cursor: pointer;
    color: var(--text-main); transition: background 0.2s;
}
.cloud-login-btn:active { background: #f5f5f5; }
.cloud-login-btn svg { flex-shrink: 0; }
.cloud-actions { display: flex; gap: 8px; margin-top: 10px; }
.cloud-action-btn {
    flex: 1; padding: 9px 6px; border: 1.5px solid #e0e0e0; border-radius: 10px;
    background: white; font-size: 13px; font-weight: 500; cursor: pointer;
    color: var(--text-main); transition: all 0.2s;
}
.cloud-action-btn:active { background: #f5f5f5; }
.cloud-action-btn.primary { background: var(--primary); color: white; border-color: var(--primary); }
.cloud-action-btn.danger { color: var(--danger); border-color: #ffcdd2; }
.cloud-last-sync { font-size: 12px; color: var(--text-sub); margin-top: 8px; text-align: center; }

.restore-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.5); z-index: 2000; display: flex;
    align-items: center; justify-content: center;
}
.restore-card {
    background: white; width: 90%; max-width: 340px; padding: 24px;
    border-radius: var(--radius); text-align: center;
}
.restore-card h3 { margin: 0 0 8px; font-size: 17px; }
.restore-card p { font-size: 13px; color: var(--text-sub); margin: 0 0 18px; }
.restore-card .restore-btns { display: flex; gap: 10px; }
.restore-card .restore-btns button {
    flex: 1; padding: 12px; border: none; border-radius: 12px;
    font-size: 14px; font-weight: 600; cursor: pointer;
}
.restore-card .restore-btns .btn-cancel { background: #f0f0f0; color: #333; }
.restore-card .restore-btns .btn-restore { background: var(--primary); color: white; }

/* Update Modal */
.update-overlay {
    position: fixed; inset: 0; z-index: 10000;
    background: rgba(0, 0, 0, 0.5);
    display: flex; align-items: center; justify-content: center;
    padding: 20px;
    animation: updateFadeIn 0.25s ease;
}
@keyframes updateFadeIn {
    from { opacity: 0; }
    to   { opacity: 1; }
}
.update-modal {
    background: #fff; border-radius: 16px;
    padding: 28px 24px 24px; width: 100%; max-width: 360px;
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
    text-align: center;
    animation: updateScaleIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
@keyframes updateScaleIn {
    from { transform: scale(0.9); opacity: 0; }
    to   { transform: scale(1); opacity: 1; }
}
.update-modal-icon {
    width: 48px; height: 48px; margin: 0 auto 14px;
    background: linear-gradient(135deg, var(--primary) 0%, #764ba2 100%);
    border-radius: 50%; color: #fff;
    font-size: 24px; line-height: 48px; font-weight: 700;
}
.update-modal-title {
    font-size: 17px; font-weight: 700; color: #222;
    margin: 0 0 16px;
}
.update-modal-changes {
    text-align: left; font-size: 13.5px; color: #444;
    line-height: 1.7; margin: 0 0 16px 8px; padding-left: 14px;
}
.update-modal-changes li { margin-bottom: 4px; }
.update-modal-notice {
    font-size: 13px; color: #c0392b; font-weight: 600;
    margin: 0 0 20px; line-height: 1.5;
}
.update-modal-btn {
    width: 100%; padding: 12px; border: none; border-radius: 12px;
    background: linear-gradient(135deg, var(--primary) 0%, #764ba2 100%);
    color: #fff; font-size: 15px; font-weight: 600;
    cursor: pointer; transition: opacity 0.2s;
}
.update-modal-btn:active { opacity: 0.85; }

/* About Page */
.about-page { text-align: center; padding: 20px 0 40px; }
.about-icon-circle {
    width: 88px; height: 88px; border-radius: 50%; margin: 0 auto 16px;
    background: linear-gradient(135deg, var(--primary-light) 0%, #d4d3ff 100%);
    display: flex; align-items: center; justify-content: center;
    color: var(--primary);
}
.about-name { font-size: 22px; font-weight: 700; margin: 0 0 10px; color: var(--text-main); }
.about-bio {
    font-size: 14px; color: var(--text-sub); line-height: 1.7;
    margin: 0 auto 30px; max-width: 320px;
}
.about-links { display: flex; flex-direction: column; gap: 12px; }
.about-link-card {
    display: flex; align-items: center; gap: 14px;
    padding: 16px 18px; background: var(--card-bg); border-radius: 16px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.04); text-decoration: none;
    transition: transform 0.1s, box-shadow 0.2s;
}
.about-link-card:active { transform: scale(0.98); box-shadow: 0 1px 4px rgba(0,0,0,0.08); }
.about-link-icon {
    width: 44px; height: 44px; border-radius: 12px;
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
}
.about-link-icon.fb { background: #E7F0FF; color: #1877F2; }
.about-link-icon.linkedin { background: #E8F4FD; color: #0A66C2; }
.about-link-icon.github { background: #F0F0F0; color: #24292F; }
.about-link-icon.coffee { background: #FFF3E0; color: #FF813F; }
.about-link-text { flex: 1; text-align: left; }
.about-link-title { font-size: 15px; font-weight: 600; color: var(--text-main); display: block; }
.about-link-desc { font-size: 12px; color: var(--text-sub); display: block; margin-top: 2px; }
.about-link-arrow { color: var(--text-sub); flex-shrink: 0; display: flex; align-items: center; }
.about-link-card.coffee {
    background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%);
    border: 1.5px solid #FFD54F;
}
.about-link-icon.email { background: #E3F2FD; color: #1565C0; }
.about-version {
    font-size: 13px; color: var(--text-sub); margin-top: 32px; opacity: 0.6;
}
.about-footer {
    font-size: 12px; color: var(--text-sub); margin-top: 8px; opacity: 0.7;
}

/* PWA Install Prompt */
.install-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.5); z-index: 3000;
    display: flex; align-items: flex-end; justify-content: center;
    opacity: 0; transition: opacity 0.3s ease;
}
.install-overlay.active { opacity: 1; }
.install-card {
    background: var(--card-bg); width: 100%; max-width: 500px;
    border-top-left-radius: 24px; border-top-right-radius: 24px;
    padding: 32px 24px max(32px, var(--safe-area-bottom));
    box-shadow: 0 -10px 40px rgba(0,0,0,0.15);
    text-align: center;
    transform: translateY(100%); transition: transform 0.35s cubic-bezier(0.175,0.885,0.32,1.275);
}
.install-overlay.active .install-card { transform: translateY(0); }
.install-app-icon {
    width: 72px; height: 72px; border-radius: 16px;
    box-shadow: 0 4px 16px rgba(88,86,214,0.2); margin-bottom: 16px;
}
.install-title {
    font-size: 20px; font-weight: 700; color: var(--text-main);
    margin: 0 0 6px; line-height: 1.4;
}
.install-subtitle {
    font-size: 14px; color: var(--text-sub); margin: 0 0 20px;
}
.install-benefits {
    display: flex; flex-direction: column; gap: 10px;
    text-align: left; margin-bottom: 24px;
    background: #f8f8fa; border-radius: 14px; padding: 14px 16px;
}
.install-benefit {
    display: flex; align-items: center; gap: 10px;
    font-size: 14px; font-weight: 500; color: var(--text-main);
}
.install-benefit-icon {
    width: 36px; height: 36px; border-radius: 10px;
    background: var(--primary-light); color: var(--primary);
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
}
.install-steps {
    display: flex; flex-direction: column; gap: 14px;
    text-align: left; margin-bottom: 24px;
}
.install-step {
    display: flex; align-items: center; gap: 12px; font-size: 14px; color: var(--text-main);
}
.install-step-num {
    width: 28px; height: 28px; border-radius: 50%;
    background: var(--primary); color: white;
    display: flex; align-items: center; justify-content: center;
    font-size: 13px; font-weight: 700; flex-shrink: 0;
}
.install-step-text { line-height: 1.5; }
.install-share-icon {
    display: inline-block; vertical-align: middle;
    color: var(--primary); margin-left: 2px;
}
.install-primary-btn {
    width: 100%; padding: 15px; background: var(--primary); color: white;
    border: none; border-radius: 14px; font-size: 16px; font-weight: 600;
    cursor: pointer; transition: transform 0.1s;
}
.install-primary-btn:active { transform: scale(0.98); }
.install-secondary-actions {
    display: flex; justify-content: center; gap: 16px; margin-top: 12px;
}
.install-later-btn, .install-never-btn {
    background: none; border: none; font-size: 13px;
    color: var(--text-sub); cursor: pointer; padding: 4px 8px;
}
.install-later-btn:active, .install-never-btn:active { color: var(--text-main); }
.install-generic-hint {
    font-size: 14px; color: var(--text-sub); line-height: 1.7;
    margin: 0 0 20px;
}
